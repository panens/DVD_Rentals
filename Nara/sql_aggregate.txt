CREATE TABLE IF NOT EXISTS dssa.FACT_RENTAL as (SELECT COUNT (rental_id) as count_rentals,(SELECT customer_id as sk_customer FROM customer where customer_id = rental.customer_id), rental_date as sk_date, (SELECT store_id as sk_store FROM store where store_id = (SELECT store_id from inventory where inventory_id = rental.inventory_id)), (SELECT film_id as sk_film FROM film where film_id = (SELECT film_id from inventory where inventory_id = rental.inventory_id)),(SELECT staff_id as sk_staff FROM staff where staff_id = rental.staff_id)from rental GROUP BY sk_customer, sk_date, sk_store, sk_film, sk_staff) 
ALTER TABLE dssa.FACT_RENTAL ADD FOREIGN KEY (sk_customer) REFERENCES dssa.customer(sk_customer), ADD FOREIGN KEY (sk_date) REFERENCES dssa.date(sk_date), ADD FOREIGN KEY (sk_film) REFERENCES dssa.film(sk_film), ADD FOREIGN KEY (sk_store) REFERENCES dssa.store(sk_store), ADD FOREIGN KEY (sk_staff) REFERENCES dssa.staff(sk_staff)