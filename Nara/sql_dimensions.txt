CREATE TABLE IF NOT EXISTS dssa.DATE as (SELECT DISTINCT rental_date as sk_date, Extract(QUARTER FROM rental_date) as quarter, Extract(year FROM rental_date) as year, Extract(month FROM rental_date) as month, Extract(day FROM rental_date) as day FROM RENTAL)
ALTER TABLE dssa.date ADD Primary Key (sk_date)
CREATE TABLE IF NOT EXISTS dssa.STAFF as (SELECT staff_id as sk_staff, CONCAT(first_name, ' ', last_name) as name, email from staff)
ALTER TABLE dssa.staff ADD Primary Key (sk_staff)
CREATE TABLE IF NOT EXISTS dssa.CUSTOMER as (SELECT customer_id as sk_customer, CONCAT(first_name, ' ', last_name) as full_name, email as email FROM customer)
ALTER TABLE dssa.customer ADD Primary Key (sk_customer)
CREATE TABLE IF NOT EXISTS dssa.STORE as (SELECT store_id as sk_store, (SELECT CONCAT(first_name, ' ', last_name) as name from staff where store_id = STORE.store_id), (SELECT address from address where address_id = store.address_id), (SELECT city from city where city_id = (SELECT city_id from address where address_id = store.address_id)),(SELECT district as state from address where address_id = store.address_id), (SELECT country from country where country_id = (SELECT country_id from city where city_id = (SELECT city_id from address where address_id = store.address_id)))from STORE)
ALTER TABLE dssa.store ADD Primary Key (sk_store)
CREATE TABLE IF NOT EXISTS dssa.FILM as (select film_id as sk_film, rating as rating_code, length as film_duration, rental_duration, release_year, (SELECT name from language where language_id = film.language_id), title from film)
ALTER TABLE dssa.film ADD Primary Key (sk_film)